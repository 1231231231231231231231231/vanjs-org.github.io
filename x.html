<!DOCTYPE html>
<html lang="en"><head>
    <link rel="icon" href="/logo.svg">
    <title>VanX - The 1.0 kB Official VanJS Extension</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      @font-face {
        font-family: 'Poppins';
        font-style: normal;
        font-weight: 400;
        src: url(https://fonts.gstatic.com/s/poppins/v20/pxiEyp8kv8JHgFVrJJfedw.ttf) format('truetype');
      }
    </style>
    <link rel="stylesheet" href="/w3.css">
    <link rel="stylesheet" href="/prism.css">
    <link rel="stylesheet" href="/vanjs.css">
  </head>
  <body class="line-numbers" data-prismjs-copy="üìã">
    <!-- Google tag (gtag.js) -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-Q0NB75RY7E"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-Q0NB75RY7E');
    </script>
    <!-- Sidebar/menu -->
    <nav class="w3-sidebar w3-red w3-collapse w3-top w3-large w3-padding" style="z-index:3;width:280px;font-weight:bold;" id="mySidebar"><br>
      <a href="javascript:void(0)" onclick="w3_close()" class="w3-button w3-hide-large w3-display-topleft" style="width:100%;font-size:22px">Close Menu</a>
      <div class="w3-container">
        <h1 class="w3-padding-16 w3-xxxlarge">
          <img src="/logo.svg" alt="VanJS" width="192px" height="192px">
        </h1>
      </div>
      <div id="nav" class="w3-bar-block"><a href="/" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Home</a><a href="/start" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Getting Started</a><a href="/tutorial" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Tutorial</a><a href="/demo" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">VanJS by Example</a><a href="/convert" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">HTML/MD to VanJS</a><a href="/vanui" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">VanUI</a><a href="/minivan" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Mini-Van</a><a href="/ssr" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">SSR &amp; Hydration</a><a href="/x" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white current">X</a><a href="/advanced" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Advanced Topics</a><a href="/media" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">Media Mentions</a><a href="/about" onclick="w3_close()" class="w3-bar-item w3-button w3-hover-white">About</a></div>
    </nav>

    <!-- Top menu on small screens -->
    <header class="w3-container w3-top w3-hide-large w3-red w3-xlarge w3-padding">
      <a href="javascript:void(0)" class="w3-button w3-red w3-margin-right" onclick="w3_open()">‚ò∞</a>
      <span id="title-bar">X</span>
    </header>

    <!-- Overlay effect when opening sidebar on small screens -->
    <div class="w3-overlay w3-hide-large" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

    <!-- !PAGE CONTENT! -->
    <div class="w3-main" style="margin-left:300px;">
      <div id="page">
        <div id="content"><h1 class="w3-xxlarge"><strong>VanX: The 1.0 kB Official VanJS Extension</strong></h1><p><b>VanX</b> is the official extension of <b>VanJS</b>, which provides handy utility functions. <b>VanX</b> makes <b>VanJS</b> more ergonomic for certain use cases and its developer experience closer to other popular UI frameworks. Like <b>VanJS</b>, <b>VanX</b> is also ultra-lightweight, with just 1.0kB in the gzipped minified bundle.</p><h2 class="w3-xxlarge w3-text-red" id="installation"><a class="self-link" href="#installation">Installation</a></h2><hr style="width:50px;border:5px solid red" class="w3-round"><h3 class="w3-large w3-text-red" id="via-npm"><a class="self-link" href="#via-npm">Via NPM</a></h3><p><b>VanX</b> is published as NPM package <a href="https://www.npmjs.com/package/vanjs-ext" class="w3-hover-opacity">vanjs-ext</a>. Run the following command to install the package:</p><pre><code class="language-shell">npm install vanjs-ext</code></pre><p>Add this line to your script to import the package:</p><pre><code class="language-js">import * as vanX from "vanjs-ext"</code></pre><p>You can also import individual utility functions you're going to use:</p><pre><code class="language-js">import { &lt;functions you want to use&gt; } from "vanjs-ext"</code></pre><h3 class="w3-large w3-text-red" id="via-a-script-tag"><a class="self-link" href="#via-a-script-tag">Via a Script Tag</a></h3><p>Alternatively, you can import <b>VanX</b> from CDN via a <code class="language-js">&lt;script type="text/javascript"&gt;</code>&nbsp;tag:</p><pre><code class="language-html">&lt;script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vanjs-ext@0.1.2/dist/van-x.nomodule.min.js"&gt;&lt;/script&gt;</code></pre><p><code class="symbol">https://cdn.jsdelivr.net/npm/vanjs-ext@0.1.2/dist/van-x.nomodule.js</code> can be used for the non-minified version.</p><p>Note that: <b>VanJS</b> needs to be <a href="/start" class="w3-hover-opacity">imported</a> via a <code class="language-js">&lt;script type="text/javascript"&gt;</code> tag for <b>VanX</b> to work properly.</p><h2 class="w3-xxlarge w3-text-red" id="reactive-object"><a class="self-link" href="#reactive-object"><code class="symbol">vanX.reactive</code>: Reactive Object to Hold Many Individual States</a></h2><hr style="width:50px;border:5px solid red" class="w3-round"><p><code class="symbol">vanX.reactive</code> provides an ergonomic way to define a single reactive object where each of its individual fields corresponds to an underlying <code class="symbol">State</code> object. For instance:</p><pre><code class="language-js">const obj = vanX.reactive({a: 1, b: 2})</code></pre><p>defines a reactive object with the following underlying state fields:</p><pre><code class="language-js">{a: van.state(1), b: van.state(2)}</code></pre><p>The reactive objects defined by <code class="symbol">vanX.reactive</code> can be deeply nested. For instance:</p><pre><code class="language-js">const obj = vanX.reactive({
  a: 1,
  b: {
    c: 2,
    d: 3,
  },
})</code></pre><p>defines a reactive object with the following underlying state fields:</p><pre><code class="language-js">{
  a: van.state(1),
  b: van.state({
    c: van.state(2),
    d: van.state(3),
  }),
}</code></pre><p>Getting and setting values of the underlying states can be simply done by getting / setting the fields of the reactive object. For instance, <code class="language-js">obj.b.c</code>&nbsp;is equivalent to what you would have to write <code class="language-js">obj.b.val.c.val</code> had the underlying state object been accessed.</p><h3 class="w3-large w3-text-red" id="a-practical-example"><a class="self-link" href="#a-practical-example">A practical example</a></h3><p>Now, let's take a look at a practice example on how <code class="symbol">vanX.reactive</code> can help group multiple states into a single reactive object in your application:</p><pre><code class="language-js">const Name = () =&gt; {
  const data = vanX.reactive({name: {first: "Tao", last: "Xin"}})
  return div(
    "First name: ",
    input({type: "text", value: () =&gt; data.name.first,
      oninput: e =&gt; data.name.first = e.target.value}), "&nbsp;",
    "Last name: ",
    input({type: "text", value: () =&gt; data.name.last,
      oninput: e =&gt; data.name.last = e.target.value}), " ",
    "Full name: ", () =&gt; `${data.name.first} ${data.name.last}`, " ",
    button({onclick: () =&gt; data.name = {first: "Tao", last: "Xin"}}, "Reset"),
  )
}
</code></pre><p><b>Demo:</b></p><p id="demo-name"></p><p><a href="https://jsfiddle.net/gh/get/library/pure/vanjs-org/vanjs-org.github.io/tree/master/jsfiddle/x/name">Try on jsfiddle</a></p><p>Note that, not only you can set the value of each individual leaf field, you can also set the entire object of the <code class="symbol">name</code> field, as what's being done in the <code class="symbol">onclick</code> handler of the <code class="symbol">Reset</code> button:</p><pre><code class="language-js">button({onclick: () =&gt; data.name = {first: "Tao", last: "Xin"}}, "Reset")</code></pre><p>‚ö†Ô∏è <b>Caveat</b>: Accessing to any sub-field of the reactive object needs to be wrapped inside a binding function. Otherwise, your app won't be reactive to the sub-field changes.</p><p id="caveat-no-aliasing">‚ö†Ô∏è <b>Caveat</b>: DO NOT alias any sub-field of the reactive object into other variables. Doing so will break the dependency detection when the sub-field alias is used in a binding function.</p><h3 class="w3-large w3-text-red" id="calculated-fields"><a class="self-link" href="#calculated-fields">Calculated fields</a></h3><p>You can specify calculated fields (similar to <a href="/tutorial#derived-state" class="w3-hover-opacity">derived states</a> in <b>VanJS</b>) with <code class="symbol">vanX.calc</code>. The example above can be rewritten to the code below:</p><pre><code class="language-js">const Name = () =&gt; {
  const data = vanX.reactive({name: {first: "Tao", last: "Xin"}})
  data.fullName = vanX.calc(() =&gt; `${data.name.first} ${data.name.last}`)
  return div(
    "First name: ",
    input({type: "text", value: () =&gt; data.name.first,
      oninput: e =&gt; data.name.first = e.target.value}), "&nbsp;",
    "Last name: ",
    input({type: "text", value: () =&gt; data.name.last,
      oninput: e =&gt; data.name.last = e.target.value}), " ",
    "Full name: ", () =&gt; data.fullName, " ",
    button({onclick: () =&gt; data.name = {first: "Tao", last: "Xin"}}, "Reset"),
  )
}
</code></pre><p><b>Demo:</b></p><p id="demo-name-calc"></p><p><a href="https://jsfiddle.net/gh/get/library/pure/vanjs-org/vanjs-org.github.io/tree/master/jsfiddle/x/name-calc">Try on jsfiddle</a></p><p>‚ö†Ô∏è <b>Caveat</b>: Avoid self-referencing when specify calculated fields. For instance, the code below:</p><pre><code class="language-js">const data = vanX.reactive({
  name: {first: "Tao", last: "Xin"},
  fullName: vanX.calc(() =&gt; `${data.name.first} ${data.name.last}`),
})</code></pre><p>will lead to <code class="symbol">ReferenceError</code> as <code class="symbol">data</code> variable is not yet defined when the calculation function is being executed.</p><p>You can either insert the new calculated fields after the reactive object is built (like what's done in the example above), or defining all the calculated fields in a separate reactive object.</p><h3 class="w3-large w3-text-red" id="get-the-underlying-state-object"><a class="self-link" href="#get-the-underlying-state-object">Get the underlying <code class="symbol">State</code> object</a></h3><p>Sometimes, it's desirable to get the underlying <code class="symbol">State</code> objects for fields in a reactive object. This can be achieved with <code class="symbol">vanX.stateFields</code>. The example above can be modified to use the underlying state field instead of the binding function for <code class="symbol">Full name</code>:</p><pre><code class="language-js">const Name = () =&gt; {
  const data = vanX.reactive({name: {first: "Tao", last: "Xin"}})
  data.fullName = vanX.calc(() =&gt; `${data.name.first} ${data.name.last}`)
  return div(
    "First name: ",
    input({type: "text", value: () =&gt; data.name.first,
      oninput: e =&gt; data.name.first = e.target.value}), "&nbsp;",
    "Last name: ",
    input({type: "text", value: () =&gt; data.name.last,
      oninput: e =&gt; data.name.last = e.target.value}), " ",
    "Full name: ", vanX.stateFields(data).fullName, " ",
    button({onclick: () =&gt; data.name = {first: "Tao", last: "Xin"}}, "Reset"),
  )
}
</code></pre><p><b>Demo:</b></p><p id="demo-name-state-fields"></p><p><a href="https://jsfiddle.net/gh/get/library/pure/vanjs-org/vanjs-org.github.io/tree/master/jsfiddle/x/name-state-fields">Try on jsfiddle</a></p><p>Note that, <code class="symbol">stateFields</code> only gets the underlying state fields for one layer of the reactive object. For instance, to get the state field for <code class="symbol">First name</code>, you need to write:</p><pre><code class="language-js">vanX.stateFields(vanX.stateFields(data).name.val).first</code></pre><h3 class="w3-large w3-text-red" id="add-reactivity-to-existing-javascript-classes"><a class="self-link" href="#add-reactivity-to-existing-javascript-classes">Add reactivity to existing JavaScript classes</a></h3><p>It's possible to add reactivity to objects of existing JavaScript classes with the help of <code class="symbol">vanX.reactive</code>. For instance, the code below adds the reactivity to a <code class="symbol">Person</code> object:</p><pre><code class="language-js">class Person {
  constructor(firstName, lastName) { this.firstName = firstName; this.lastName = lastName }
  get fullName() { return `${this.firstName} ${this.lastName}` }
}

const Name = () =&gt; {
  const person = vanX.reactive(new Person("Tao", "Xin"))
  return div(
    "First name: ",
    input({type: "text", value: () =&gt; person.firstName,
      oninput: e =&gt; person.firstName = e.target.value}), "&nbsp;",
    "Last name: ",
    input({type: "text", value: () =&gt; person.lastName,
      oninput: e =&gt; person.lastName = e.target.value}), " ",
    "Full name: ", () =&gt; person.fullName, " ",
    button({onclick: () =&gt; (person.firstName = "Tao", person.lastName = "Xin")}, "Reset"),
  )
}
</code></pre><p><b>Demo:</b></p><p id="demo-name-existing-class"></p><p><a href="https://jsfiddle.net/gh/get/library/pure/vanjs-org/vanjs-org.github.io/tree/master/jsfiddle/x/name-existing-class">Try on jsfiddle</a></p><p>‚ö†Ô∏è <b>Caveat</b>: Once an object is turned reactive with <code class="symbol">vanX.reactive</code>, you shouldn't access the original object anymore. Doing so will create the same issue as <a href="#caveat-no-aliasing" class="w3-hover-opacity">aliasing</a>.</p><p>‚ö†Ô∏è <b>Caveat</b>: There might be issues if you try to add reactivity to an object implemented in native code (not in JavaScript). Example: <a href="https://github.com/vanjs-org/van/issues/156" class="w3-hover-opacity">#156</a>.</p><h3 class="w3-large w3-text-red" id="api-reactive"><a class="self-link" href="#api-reactive">API reference: <code class="symbol">vanX.reactive</code></a></h3><table><tbody><tr><td><b>Signature</b></td><td><code class="language-js">vanX.reactive(obj) =&gt; &lt;the created reactive object&gt;</code></td></tr><tr><td><b>Description</b></td><td>Converts the input object <code class="symbol">obj</code> into a reactive object.</td></tr><tr><td><b>Parameters</b></td><td><ul><li><b><code class="symbol">obj</code></b> - Can be a plain object or an object of an existing JavaScript class. <code class="symbol">obj</code> can have deeply nested fields. The original <code class="symbol">obj</code> shouldn't be accessed anymore after the <code class="language-js">vanX.reactive(obj)</code> call.</li></ul></td></tr><tr><td><b>Returns</b></td><td>The created reactive object.</td></tr></tbody></table><p>‚ö†Ô∏è <b>Caveat</b>: The passed-in <code class="symbol">obj</code> object shouldn't have any <code class="symbol">State</code> fields. Doing so will result in states of other <code class="symbol">State</code> objects, which is <a href="/tutorial#public-interface-of-state-objects" class="w3-hover-opacity">invalid</a> in <b>VanJS</b>.</p><h3 class="w3-large w3-text-red" id="api-calc"><a class="self-link" href="#api-calc">API reference: <code class="symbol">vanX.calc</code></a></h3><table><tbody><tr><td><b>Signature</b></td><td><code class="language-js">vanX.calc(f) =&gt; &lt;the created calculated field&gt;</code></td></tr><tr><td><b>Description</b></td><td>Creates a calculated field for a reactive object based on the calculation function<code class="symbol">f</code>.</td></tr><tr><td><b>Parameters</b></td><td><ul><li><b><code class="symbol">f</code></b> - The calculation function.</li></ul></td></tr><tr><td><b>Returns</b></td><td>The created calculated field.</td></tr></tbody></table><h3 class="w3-large w3-text-red" id="api-stateFields"><a class="self-link" href="#api-stateFields">API reference: <code class="symbol">vanX.stateFields</code></a></h3><table><tbody><tr><td><b>Signature</b></td><td><code class="language-js">vanX.stateFields(obj) =&gt; &lt;an object for all underlying state fields of obj&gt;</code></td></tr><tr><td><b>Description</b></td><td>Given a reactive object <code class="symbol">obj</code>, returns an object for all the underlying state fields of <code class="symbol">obj</code>. For instance, if <code class="symbol">obj</code> is <code class="language-js">{a: 1, b: 2}</code>, <code class="language-js">{a: van.state(1), b: van.state(2)}</code> will be returned.</td></tr><tr><td><b>Parameters</b></td><td><ul><li><b><code class="symbol">obj</code></b> - The input reactive object.</li></ul></td></tr><tr><td><b>Returns</b></td><td>An object for all the underlying state fields of <code class="symbol">obj</code>.</td></tr></tbody></table><h3 class="w3-large w3-text-red" id="a-comprehensive-example"><a class="self-link" href="#a-comprehensive-example">A comprehensive example</a></h3><p>You can refer to this <a href="https://github.com/vanjs-org/van/blob/main/x/examples/reactive/src/main.js" class="w3-hover-opacity">file</a> for a comprehensive demo of all the features regarding to reactive objects discussed above. You can preview the app via <a href="https://codesandbox.io/p/sandbox/github/vanjs-org/van/tree/main/x/examples/reactive?file=%2Fsrc%2Fmain.js%3A1%2C1" class="w3-hover-opacity">CodeSandbox</a>.</p><h2 class="w3-xxlarge w3-text-red" id="reactive-list"><a class="self-link" href="#reactive-list"><code class="symbol">vanX.list</code>: Reactive List that Minimizes Re-rendering on Updates</a></h2><hr style="width:50px;border:5px solid red" class="w3-round"><p><code class="symbol">vanX.list</code> takes an input reactive object and builds a list of UI elements whose contents are updated whenever any field of the input reactive object changes. The input reactive object can either be an <code class="symbol"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" class="w3-hover-opacity">Array</a></code> for non-keyed input, or a plain object for keyed input.</p><p>Let's first take a look at some simple examples.</p><p><code class="symbol">Array</code> for non-keyed input:</p><pre><code class="language-js">const items = vanX.reactive([1, 2, 3])
return vanX.list(ul, items, v =&gt; li(v))
</code></pre><p>Plain object for keyed input:</p><pre><code class="language-js">const items = vanX.reactive({a: 1, b: 2, c: 3})
return vanX.list(ul, items, v =&gt; li(v))
</code></pre><p>In both examples, <code class="language-html">&lt;ul&gt;&lt;li&gt;1&lt;/li&gt;&lt;li&gt;2&lt;/li&gt;&lt;li&gt;3&lt;/li&gt;&lt;/ul&gt;</code>&nbsp;will be returned.</p><p>You can add, update, and delete entries in the reactive object <code class="symbol">items</code>, and the rendered UI elements are bound to the changes while minimizing the re-rendering of the DOM tree. For instance, if you do the following changes to the <code class="symbol">Array</code> example:</p><pre><code class="language-js">++items[0]
delete items[1]
items.push(4)
</code></pre><p>the rendered UI elements will be updated to <code class="language-html">&lt;ul&gt;&lt;li&gt;2&lt;/li&gt;&lt;li&gt;3&lt;/li&gt;&lt;li&gt;4&lt;/li&gt;&lt;/ul&gt;</code>.</p><p>For keyed object, the following changes will produce the same result:</p><pre><code class="language-js">++items.a
delete items.b
items.d = 4
</code></pre><p>In addition, for <code class="symbol">Array</code>-based input <code class="symbol">items</code>, you can call <code class="symbol"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/shift" class="w3-hover-opacity">shift</a></code>, <code class="symbol"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/unshift" class="w3-hover-opacity">unshift</a></code> and <code class="symbol"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice" class="w3-hover-opacity">splice</a></code> as you would normally do to an array. The rendered UI elements are guaranteed to be in sync. For instance, after executing the following code:</p><pre><code class="language-js">const items = vanX.reactive([1, 2, 3])
const dom = vanX.list(ul, items, v =&gt; li(v))

items.shift()
items.unshift(4)
items.splice(1, 1, 5)
</code></pre><p><code class="symbol">dom</code> will become <code class="language-html">&lt;ul&gt;&lt;li&gt;4&lt;/li&gt;&lt;li&gt;5&lt;/li&gt;&lt;li&gt;3&lt;/li&gt;&lt;/ul&gt;</code>.</p><h3 class="w3-large w3-text-red" id="api-list"><a class="self-link" href="#api-list">API Reference: <code class="symbol">vanX.list</code></a></h3><table><tbody><tr><td><b>Signature</b></td><td><code class="language-js">vanX.list(containerFunc, items, itemFunc) =&gt; &lt;the root element of the created DOM tree&gt;</code></td></tr><tr><td><b>Description</b></td><td>Creates a DOM tree for a list of UI elements based on the input reactive object <code class="symbol">items</code>.</td></tr><tr><td><b>Parameters</b></td><td><ul><li><b><code class="symbol">containerFunc</code></b> - The function (<code class="language-js">() =&gt; Element</code>) that returns the container element for the list of UI elements. <b>VanJS</b> <code class="symbol"><a href="/tutorial#api-tags" class="w3-hover-opacity">tag functions</a></code>&nbsp;can be used here. For instance, specifying <code class="language-js">van.tags.ul</code>&nbsp;means we want to create a <code class="language-html">&lt;ul&gt;</code> element as the container of the list.</li><li><b><code class="symbol">items</code></b> - A reactive object that holds the data for the list. Can be an <code class="symbol">Array</code> (for non-keyed input) or a plain object (for keyed input).</li><li><b><code class="symbol">itemFunc</code></b> - The function (<code class="language-js">(v, deleter) =&gt; Node</code>) that is used to generate the UI element (or rarely, text node) for each list item. The function takes the following parameters:<ul><li><code class="symbol">v</code> - A <code class="symbol">State</code> object corresponding to each list item. You can directly use it as a <code class="symbol">State</code>-based <a href="/tutorial#state-typed-prop" class="w3-hover-opacity">property</a> / <a href="/tutorial#state-typed-child" class="w3-hover-opacity">child node</a>, read its value for building the UI element, and/or set its value in some event handlers.</li><li><code class="symbol">deleter</code>&nbsp;- a function (<code class="language-js">() =&gt; void</code>) that can be used in the event handler to delete the entire item. Typically the <code class="symbol">deleter</code> function can be used as the <code class="symbol">onclick</code>&nbsp;handler of a deletion button.</li></ul></li></ul></td></tr><tr><td><b>Returns</b></td><td>The root element of the created DOM tree.</td></tr></tbody></table><h3 class="w3-large w3-text-red" id="a-simplified-todo-app"><a class="self-link" href="#a-simplified-todo-app">A simplified TODO App</a></h3><p>Now, let's take a look at a practical example: The <a href="/demo#todo-app" class="w3-hover-opacity">Fully Reactive TODO App</a> in <a href="/demo" class="w3-hover-opacity">VanJS by Example</a>&nbsp;page can be re-implemented with the help of <code class="symbol">vanX.list</code>. We can see how a 40+ lines of code is simplified to just over 10 lines:</p><pre><code class="language-js">const TodoList = () =&gt; {
  const items = vanX.reactive(JSON.parse(localStorage.getItem("appState") ?? "[]"))
  van.derive(() =&gt; localStorage.setItem("appState", JSON.stringify(items.filter(_ =&gt; 1))))
  const inputDom = input({type: "text"})
  return div(
    inputDom, button({onclick: () =&gt; items.push({text: inputDom.value, done: false})}, "Add"),
    vanX.list(div, items, ({val: v}, deleter) =&gt; div(
      input({type: "checkbox", checked: () =&gt; v.done, onclick: e =&gt; v.done = e.target.checked}),
      () =&gt; (v.done ? strike : span)(v.text),
      a({onclick: deleter}, "‚ùå"),
    )),
  )
}
</code></pre><p><b>Demo:</b></p><p id="demo-todo-list"></p><p><a href="https://jsfiddle.net/gh/get/library/pure/vanjs-org/vanjs-org.github.io/tree/master/jsfiddle/x/todo-list">Try on jsfiddle</a></p><p>You might notice how easy it is to serialize/deserialize a complex reactive object into/from external storage. This is indeed one notable benefit of reactive objects provided by <code class="symbol"><a href="#reactive-object" class="w3-hover-opacity">vanX.reactive</a></code>.</p><p>Note that we are calling <code class="language-js">items.filter(_ =&gt; 1)</code>&nbsp;before serializing to the JSON string via <code class="language-js">JSON.stringify</code>. This is because after some deletions of items, there will be <a href="https://2ality.com/2015/09/holes-arrays-es6.html" class="w3-hover-opacity">holes</a> in the <code class="symbol">items</code> array, which can result <code class="symbol">null</code> values in the result JSON string and cause problems when the JSON string is deserialized. <code class="language-js">items.filter(_ =&gt; 1)</code> eliminates the holes (See a <a href="https://github.com/vanjs-org/van/discussions/144#discussioncomment-7342023" class="w3-hover-opacity">detailed explanation here</a>).</p><h3 class="w3-large w3-text-red" id="update-insert-delete-and-reorder-items-in-batch-with-vanx-replace"><a class="self-link" href="#update-insert-delete-and-reorder-items-in-batch-with-vanx-replace">Update, insert, delete and reorder items in batch with <code class="symbol">vanX.replace</code></a></h3><p>In addition to updating the <code class="symbol">items</code>&nbsp;object one item at a time, we also provide the <code class="symbol">vanX.replace</code>&nbsp;function that allows you to update, insert, delete and reorder items in batch. The <code class="symbol">vanX.replace</code>&nbsp;function takes the <code class="symbol">items</code>&nbsp;object and a replace function as its input parameters, and is responsible for updating the <code class="symbol">items</code> object as well as UI elements bound to it based on the new data returned by the replace function. Let's take a look at a few examples:</p><pre><code class="language-js">// Assume we have a few TODO items as following:
const todoItems = vanX.reactive([
  {text: "Implement VanX", done: true},
  {text: "Test VanX", done: false},
  {text: "Write a tutorial for VanX", done: false},
])

// To delete items in batch
const clearCompleted = () =&gt; vanX.replace(todoItems, l =&gt; l.filter(v =&gt; !v.done))

// To update items in batch
const appendText = () =&gt;
  vanX.replace(todoItems, l =&gt; l.map(v =&gt; ({text: v.text + "!", done: v.done})))

// To reorder items in batch
const sortItems = () =&gt;
  vanX.replace(todoItems, l =&gt; l.toSorted((a, b) =&gt; a.localeCompare(b)))

// To insert items in batch
const duplicateItems = () =&gt; vanX.replace(todoItems, l =&gt;
  l.flatMap(v =&gt; [v, {text: v.text + " copy", done: v.done}]))
</code></pre><h3 class="w3-large w3-text-red" id="api-replace"><a class="self-link" href="#api-replace">API reference: <code class="symbol">vanX.replace</code></a></h3><table><tbody><tr><td><b>Signature</b></td><td><code class="language-js">vanX.replace(items, f) =&gt; void</code></td></tr><tr><td><b>Description</b></td><td>Updates the reactive object <code class="symbol">items</code> and UI elements bound to it based on the data returned by the replace function <code class="symbol">f</code>.</td></tr><tr><td><b>Parameters</b></td><td><ul><li><b><code class="symbol">items</code></b> - The reactive object that you want to update.</li><li><b><code class="symbol">f</code></b> - The replace function, which takes the current values of <code class="symbol">items</code>&nbsp;as input and returns the new values of the update. If <code class="symbol">items</code>&nbsp;is an array (for non-keyed data), <code class="symbol">f</code>&nbsp;will take its values as an array (after eliminating holes with <code class="language-js">filter(_ =&gt; 1)</code>, see a <a href="https://github.com/vanjs-org/van/discussions/144#discussioncomment-7342023" class="w3-hover-opacity">detailed explanation</a> of hole elimination) and return the updated values as another array. If <code class="symbol">items</code> is a plain object (for keyed data), <code class="symbol">f</code>&nbsp;will take its values as an array of key value pairs (the data you would get with <code class="language-js">Object.entries(items)</code>) and return the updated values as another array of key value pairs.</li></ul></td></tr><tr><td><b>Returns</b></td><td><code class="language-ts">void</code></td></tr></tbody></table><h3 class="w3-large w3-text-red" id="example-1-sortable-list"><a class="self-link" href="#example-1-sortable-list">Example 1: sortable list</a></h3><p>Let's look at a sample app that we can build with <code class="symbol">vanX.list</code>&nbsp;and <code class="symbol">vanX.replace</code> - a list that you can add/delete items, sort items in ascending or descending order, and append a string to all items in the list:</p><pre><code class="language-js">const List = () =&gt; {
  const items = vanX.reactive([])
  const inputDom = input({type: "text"})

  return div(
    div(inputDom, button({onclick: () =&gt; items.push(inputDom.value)}, "Add")),
    vanX.list(ul, items, (v, deleter) =&gt; li(v, " ", a({onclick: deleter}, "‚ùå"))),
    div(
      button({onclick: () =&gt; vanX.replace(items, l =&gt; l.toSorted())}, "A -&gt; Z"),
      button({onclick: () =&gt; vanX.replace(items,
        l =&gt; l.toSorted((a, b) =&gt; b.localeCompare(a)))}, "Z -&gt; A"),
      button({onclick: () =&gt; vanX.replace(items, l =&gt; l.map(v =&gt; v + "!"))}, 'Append "!"'),
    ),
  )
}
</code></pre><p><b>Demo:</b></p><p id="demo-example-list1"></p><p><a href="https://jsfiddle.net/gh/get/library/pure/vanjs-org/vanjs-org.github.io/tree/master/jsfiddle/x/example-list1">Try on jsfiddle</a></p><h3 class="w3-large w3-text-red" id="example-2-an-advanced-sortable-todo-list"><a class="self-link" href="#example-2-an-advanced-sortable-todo-list">Example 2: an advanced sortable TODO list</a></h3><p>Now, let's take a look at a more advanced example - a sortable TODO list, which is implemented with keyed data. i.e.: reactive <code class="symbol">items</code>&nbsp;is a plain object instead of an array. In additional to the addition, deletion, sorting and appending strings that are implemented in the previous example, you can edit an item, mark an item as complete, clear all completed items and duplicate the entire list. Furthermore, the application state is serialized and persisted into <code class="symbol"><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage" class="w3-hover-opacity">localStorage</a></code>&nbsp;thus the state is preserved across page loads.</p><pre><code class="language-js">const TodoList = () =&gt; {
  const items = vanX.reactive(JSON.parse(localStorage.getItem("items") ?? "{}"))
  van.derive(() =&gt; localStorage.setItem("items", JSON.stringify(items)))

  const inputDom = input({type: "text"})
  let id = Math.max(0, ...Object.keys(items).map(v =&gt; Number(v.slice(1))))

  return div(
    div(inputDom, button(
      {onclick: () =&gt; items["k" + ++id] = {text: inputDom.value, done: false}}, "Add")),
    vanX.list(div, items, ({val: v}, deleter) =&gt; div(
      input({type: "checkbox", checked: () =&gt; v.done,
        onclick: e =&gt; v.done = e.target.checked}), " ",
      input({
        type: "text", value: () =&gt; v.text,
        style: () =&gt; v.done ? "text-decoration: line-through;" : "",
        oninput: e =&gt; v.text = e.target.value,
      }), " ",
      a({onclick: deleter}, "‚ùå"),
    )),
    div(
      button({onclick: () =&gt; vanX.replace(items, l =&gt; l.filter(([_, v]) =&gt; !v.done))},
        "Clear Completed"),
      button({onclick: () =&gt; vanX.replace(items, l =&gt;
        l.toSorted(([_1, a], [_2, b]) =&gt; a.text.localeCompare(b.text)))}, "A -&gt; Z"),
      button({onclick: () =&gt; vanX.replace(items, l =&gt;
        l.toSorted(([_1, a], [_2, b]) =&gt; b.text.localeCompare(a.text)))}, "Z -&gt; A"),
      button({onclick: () =&gt; vanX.replace(items, l =&gt;
        l.flatMap(([k1, v1]) =&gt; [
          [k1, v1],
          ["k" + ++id, {text: v1.text + "&nbsp;- copy", done: v1.done}],
        ]))},
        "Duplicate List"),
      button({onclick: () =&gt; Object.values(items).forEach(v =&gt; v.text += "!")}, 'Append "!"'),
    ),
  )
}
</code></pre><p><b>Demo:</b></p><p id="demo-example-list2"></p><p><a href="https://jsfiddle.net/gh/get/library/pure/vanjs-org/vanjs-org.github.io/tree/master/jsfiddle/x/example-list2">Try on jsfiddle</a></p><h2 class="w3-xxlarge w3-text-red" id="api-index"><a class="self-link" href="#api-index">API Index</a></h2><hr style="width:50px;border:5px solid red" class="w3-round"><p>Below is the list of all top-level APIs in <b>VanX</b>:</p><ul><li><code class="symbol"><a href="#api-reactive" class="w3-hover-opacity">vanX.reactive</a></code></li><li><code class="symbol"><a href="#api-calc" class="w3-hover-opacity">vanX.calc</a></code></li><li><code class="symbol"><a href="#api-stateFields" class="w3-hover-opacity">vanX.stateFields</a></code></li><li><code class="symbol"><a href="#api-list" class="w3-hover-opacity">vanX.list</a></code></li><li><code class="symbol"><a href="#api-replace" class="w3-hover-opacity">vanX.replace</a></code></li></ul></div>
        <aside id="toc"><ul><li><a href="#installation" class="w3-hover-opacity">Installation</a><ul><li><a href="#via-npm" class="w3-hover-opacity">Via NPM</a></li><li><a href="#via-a-script-tag" class="w3-hover-opacity">Via a Script Tag</a></li></ul></li><li><a href="#reactive-object" class="w3-hover-opacity">vanX.reactive: Reactive Object to Hold Many Individual States</a><ul><li><a href="#a-practical-example" class="w3-hover-opacity">A practical example</a></li><li><a href="#calculated-fields" class="w3-hover-opacity">Calculated fields</a></li><li><a href="#get-the-underlying-state-object" class="w3-hover-opacity">Get the underlying State object</a></li><li><a href="#add-reactivity-to-existing-javascript-classes" class="w3-hover-opacity">Add reactivity to existing JavaScript classes</a></li><li><a href="#api-reactive" class="w3-hover-opacity">API reference: vanX.reactive</a></li><li><a href="#api-calc" class="w3-hover-opacity">API reference: vanX.calc</a></li><li><a href="#api-stateFields" class="w3-hover-opacity">API reference: vanX.stateFields</a></li><li><a href="#a-comprehensive-example" class="w3-hover-opacity">A comprehensive example</a></li></ul></li><li><a href="#reactive-list" class="w3-hover-opacity">vanX.list: Reactive List that Minimizes Re-rendering on Updates</a><ul><li><a href="#api-list" class="w3-hover-opacity">API Reference: vanX.list</a></li><li><a href="#a-simplified-todo-app" class="w3-hover-opacity">A simplified TODO App</a></li><li><a href="#update-insert-delete-and-reorder-items-in-batch-with-vanx-replace" class="w3-hover-opacity">Update, insert, delete and reorder items in batch with vanX.replace</a></li><li><a href="#api-replace" class="w3-hover-opacity">API reference: vanX.replace</a></li><li><a href="#example-1-sortable-list" class="w3-hover-opacity">Example 1: sortable list</a></li><li><a href="#example-2-an-advanced-sortable-todo-list" class="w3-hover-opacity">Example 2: an advanced sortable TODO list</a></li></ul></li><li><a href="#api-index" class="w3-hover-opacity">API Index</a></li></ul></aside>
      </div>
    </div>
    <script>
      // Script to open and close sidebar
      const w3_open = () => {
        document.getElementById("mySidebar").style.display = "block"
        document.getElementById("myOverlay").style.display = "block"
      }

      const w3_close = () => {
        document.getElementById("mySidebar").style.display = "none"
        document.getElementById("myOverlay").style.display = "none"
      }

      const tocDom = document.getElementById("toc")

      // Tracks the current toc item
      const trackToc = () => {
        const allHeadings = [...document.querySelectorAll("h2,h3")]
        const currentHeadingIndex = allHeadings.findIndex(h => h.getBoundingClientRect().top >= 0)
        let currentHeading
        if (currentHeadingIndex < 0) currentHeading = allHeadings[allHeadings.length - 1]; else {
          currentHeading = allHeadings[currentHeadingIndex]
          if (currentHeadingIndex > 0 && currentHeading.getBoundingClientRect().top > innerHeight)
            currentHeading = allHeadings[currentHeadingIndex - 1]
        }
        for (const e of document.querySelectorAll("#toc li a"))
          if (e.href.split("#")[1] === currentHeading?.id) {
            e.classList.add("w3-opacity")
            const {top: tocTop, bottom: tocBottom} = tocDom.getBoundingClientRect()
            const {top: eTop, bottom: eBottom} = e.getBoundingClientRect()
            if (eBottom > tocBottom) tocDom.scrollTop += eBottom - tocBottom
            else if (eTop < tocTop) tocDom.scrollTop -= tocTop - eTop
          } else
            e.classList.remove("w3-opacity")
      }
      trackToc()
      document.addEventListener("scroll", trackToc)
      addEventListener("resize", trackToc)
    </script>
    <script type="text/javascript" src="/prism.js"></script>
    <script type="module"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="/code/diff.min.js"></script>
    <script type="text/javascript" src="/code/van-latest.nomodule.min.js"></script>
    <script type="text/javascript" src="/code/van-x.nomodule.min.js"></script>
    <script>
      const copy = e => {
        const file = e.previousElementSibling.innerText
        const importLine = file.includes("nomodule") ?
          `<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/vanjs-org/van/public/${file}"><\/script>` :
          `import van from "https://cdn.jsdelivr.net/gh/vanjs-org/van/public/${file}"`
          navigator.clipboard.writeText(importLine)
            .then(() => e.querySelector(".tooltip").innerText = "Copied")
            .catch(() => e.querySelector(".tooltip").innerText = "Copy failed")
      }

      const resetTooltip = e => e.querySelector(".tooltip").innerText = "Copy import line"
    </script>
    <script class="inline">{
  const {button, div, input} = van.tags

  const Name = () => {
    const data = vanX.reactive({name: {first: "Tao", last: "Xin"}})
    return div(
      "First name: ",
      input({type: "text", value: () => data.name.first,
        oninput: e => data.name.first = e.target.value}), "¬†",
      "Last name: ",
      input({type: "text", value: () => data.name.last,
        oninput: e => data.name.last = e.target.value}), " ",
      "Full name: ", () => `${data.name.first} ${data.name.last}`, " ",
      button({onclick: () => data.name = {first: "Tao", last: "Xin"}}, "Reset"),
    )
  }

  van.add(document.getElementById("demo-name"), Name())
}

{
  const {button, div, input} = van.tags

  const Name = () => {
    const data = vanX.reactive({name: {first: "Tao", last: "Xin"}})
    data.fullName = vanX.calc(() => `${data.name.first} ${data.name.last}`)
    return div(
      "First name: ",
      input({type: "text", value: () => data.name.first,
        oninput: e => data.name.first = e.target.value}), "¬†",
      "Last name: ",
      input({type: "text", value: () => data.name.last,
        oninput: e => data.name.last = e.target.value}), " ",
      "Full name: ", () => data.fullName, " ",
      button({onclick: () => data.name = {first: "Tao", last: "Xin"}}, "Reset"),
    )
  }

  van.add(document.getElementById("demo-name-calc"), Name())
}

{
  const {button, div, input} = van.tags

  const Name = () => {
    const data = vanX.reactive({name: {first: "Tao", last: "Xin"}})
    data.fullName = vanX.calc(() => `${data.name.first} ${data.name.last}`)
    return div(
      "First name: ",
      input({type: "text", value: () => data.name.first,
        oninput: e => data.name.first = e.target.value}), "¬†",
      "Last name: ",
      input({type: "text", value: () => data.name.last,
        oninput: e => data.name.last = e.target.value}), " ",
      "Full name: ", vanX.stateFields(data).fullName, " ",
      button({onclick: () => data.name = {first: "Tao", last: "Xin"}}, "Reset"),
    )
  }

  van.add(document.getElementById("demo-name-state-fields"), Name())
}

{
  const {button, div, input} = van.tags

  class Person {
    constructor(firstName, lastName) { this.firstName = firstName; this.lastName = lastName }
    get fullName() { return `${this.firstName} ${this.lastName}` }
  }

  const Name = () => {
    const person = vanX.reactive(new Person("Tao", "Xin"))
    return div(
      "First name: ",
      input({type: "text", value: () => person.firstName,
        oninput: e => person.firstName = e.target.value}), "¬†",
      "Last name: ",
      input({type: "text", value: () => person.lastName,
        oninput: e => person.lastName = e.target.value}), " ",
      "Full name: ", () => person.fullName, " ",
      button({onclick: () => (person.firstName = "Tao", person.lastName = "Xin")}, "Reset"),
    )
  }

  van.add(document.getElementById("demo-name-existing-class"), Name())
}

{
  const {a, button, div, input, span, strike} = van.tags

  const TodoList = () => {
    const items = vanX.reactive(JSON.parse(localStorage.getItem("appState") ?? "[]"))
    van.derive(() => localStorage.setItem("appState", JSON.stringify(items.filter(_ => 1))))
    const inputDom = input({type: "text"})
    return div(
      inputDom, button({onclick: () => items.push({text: inputDom.value, done: false})}, "Add"),
      vanX.list(div, items, ({val: v}, deleter) => div(
        input({type: "checkbox", checked: () => v.done, onclick: e => v.done = e.target.checked}),
        () => (v.done ? strike : span)(v.text),
        a({onclick: deleter}, "‚ùå"),
      )),
    )
  }

  van.add(document.getElementById("demo-todo-list"), TodoList())
}

{
  const {a, button, div, input, li, ul} = van.tags

  const List = () => {
    const items = vanX.reactive([])
    const inputDom = input({type: "text"})

    return div(
      div(inputDom, button({onclick: () => items.push(inputDom.value)}, "Add")),
      vanX.list(ul, items, (v, deleter) => li(v, " ", a({onclick: deleter}, "‚ùå"))),
      div(
        button({onclick: () => vanX.replace(items, l => l.toSorted())}, "A -> Z"),
        button({onclick: () => vanX.replace(items,
          l => l.toSorted((a, b) => b.localeCompare(a)))}, "Z -> A"),
        button({onclick: () => vanX.replace(items, l => l.map(v => v + "!"))}, 'Append "!"'),
      ),
    )
  }

  van.add(document.getElementById("demo-example-list1"), List())
}

{
  const {a, button, div, input} = van.tags

  const TodoList = () => {
    const items = vanX.reactive(JSON.parse(localStorage.getItem("items") ?? "{}"))
    van.derive(() => localStorage.setItem("items", JSON.stringify(items)))

    const inputDom = input({type: "text"})
    let id = Math.max(0, ...Object.keys(items).map(v => Number(v.slice(1))))

    return div(
      div(inputDom, button(
        {onclick: () => items["k" + ++id] = {text: inputDom.value, done: false}}, "Add")),
      vanX.list(div, items, ({val: v}, deleter) => div(
        input({type: "checkbox", checked: () => v.done,
          onclick: e => v.done = e.target.checked}), " ",
        input({
          type: "text", value: () => v.text,
          style: () => v.done ? "text-decoration: line-through;" : "",
          oninput: e => v.text = e.target.value,
        }), " ",
        a({onclick: deleter}, "‚ùå"),
      )),
      div(
        button({onclick: () => vanX.replace(items, l => l.filter(([_, v]) => !v.done))},
          "Clear Completed"),
        button({onclick: () => vanX.replace(items, l =>
          l.toSorted(([_1, a], [_2, b]) => a.text.localeCompare(b.text)))}, "A -> Z"),
        button({onclick: () => vanX.replace(items, l =>
          l.toSorted(([_1, a], [_2, b]) => b.text.localeCompare(a.text)))}, "Z -> A"),
        button({onclick: () => vanX.replace(items, l =>
          l.flatMap(([k1, v1]) => [
            [k1, v1],
            ["k" + ++id, {text: v1.text + "¬†- copy", done: v1.done}],
          ]))},
          "Duplicate List"),
        button({onclick: () => Object.values(items).forEach(v => v.text += "!")}, 'Append "!"'),
      ),
    )
  }

  van.add(document.getElementById("demo-example-list2"), TodoList())
}
</script>
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async="" defer="" src="https://buttons.github.io/buttons.js"></script>
  

</body></html>